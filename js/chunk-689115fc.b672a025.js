(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-689115fc"],{"0be3":function(e,t,n){},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,n){var r=n("1d80"),a=n("5899"),o="["+a+"]",s=RegExp("^"+o+o+"*"),c=RegExp(o+o+"*$"),l=function(e){return function(t){var n=String(r(t));return 1&e&&(n=n.replace(s,"")),2&e&&(n=n.replace(c,"")),n}};e.exports={start:l(1),end:l(2),trim:l(3)}},"5b09":function(e,t,n){"use strict";n("0be3")},7156:function(e,t,n){var r=n("861d"),a=n("d2bb");e.exports=function(e,t,n){var o,s;return a&&"function"==typeof(o=t.constructor)&&o!==n&&r(s=o.prototype)&&s!==n.prototype&&a(e,s),e}},"8daf":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-card",{staticClass:"video-upload"},[n("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"课程"}},[n("el-input",{attrs:{readonly:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"课时"}},[n("el-input",{attrs:{readonly:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"视频上传"}},[n("input",{ref:"video",attrs:{type:"file"}})]),n("el-form-item",{attrs:{label:"封面上传"}},[n("input",{ref:"image",attrs:{type:"file"}})]),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.handleUpload}},[e._v("开始上传")]),n("el-button",{on:{click:e.$router.back}},[e._v("返回")])],1),n("el-form-item",{attrs:{label:"上传进度"}},[n("el-progress",{attrs:{type:"circle",status:100===e.uploadPercent?"success":void 0,percentage:e.uploadPercent}})],1),n("el-form-item",{attrs:{label:"转码进度"}},[n("el-progress",{attrs:{type:"circle",status:100===e.transCodePercent?"success":void 0,percentage:e.transCodePercent}})],1)],1)],1)},a=[],o=(n("b0c0"),n("a9e3"),n("96cf"),n("1da1")),s=n("b32d");function c(){return s["a"].get("/boss/course/upload/aliyunImagUploadAddressAdnAuth.json")}function l(e){return s["a"].get("/boss/course/upload/aliyunVideoUploadAddressAdnAuth.json",{params:e})}function i(e){return s["a"].post("/boss/course/upload/aliyunTransCode.json",e)}function u(e){return s["a"].get("/boss/course/upload/aliyunTransCodePercent.json",{params:{lessonId:e}})}var d,f,p,m,g=n("2b0e"),b=g["default"].extend({name:"UploadVideo",props:{courseId:{type:[String,Number]}},data:function(){return{form:{name:"123"},uploadPercent:0,transCodePercent:0,uploadSuccess:!1,transCodeSuccess:!1}},created:function(){this.initUploader()},methods:{onSubmit:function(){console.log(123)},initUploader:function(){var e=this;d=new window.AliyunUpload.Vod({userId:"1618139964448548",region:"",partSize:1048576,parallel:5,retryCount:3,retryDuration:2,onUploadstarted:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n,r,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("开始上传",t),!t.isImage){e.next=10;break}return e.next=4,c();case 4:n=e.sent,r=n.data,f=m=r.data,console.log(r),e.next=17;break;case 10:return e.next=12,l({fileName:t.file.name,imageUrl:f.imageURL});case 12:a=e.sent,o=a.data,p=m=o.data,p.fileName=t.file.name,console.log(o);case 17:d.setUploadAuthAndAddress(t,m.uploadAuth,m.uploadAddress,m.videoId||m.imageId);case 18:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),onUploadSucceed:function(e){console.log("上传成功")},onUploadFailed:function(e,t,n){console.log("上传失败")},onUploadProgress:function(t,n,r){console.log(t,n,r),t.isImage||(e.uploadPercent=Math.floor(100*r),console.log(e.uploadPercent),100===e.uploadPercent&&(e.uploadSuccess=!0))},onUploadTokenExpired:function(e){console.log(e)},onUploadEnd:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(n){var r,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("onUploadEnd",n),t.next=3,i({lessonId:e.$route.query.lessonId,coverImageUrl:f.imageURL,fileName:p.fileName,fileId:p.videoId});case 3:r=t.sent,a=r.data,s=setInterval(Object(o["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u(e.$route.query.lessonId);case 2:n=t.sent,r=n.data,console.log(r),e.transCodePercent=r.data,100===r.data&&(e.transCodeSuccess=!0,e.$message.success("转码成功"),clearInterval(s));case 7:case"end":return t.stop()}}),t)}))),3e3),console.log(a),e.$message.success("上传成功");case 8:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}()})},handleUpload:function(e,t){this.uploadPercent=0,this.transCodePercent=0,this.uploadSuccess=!1,this.transCodeSuccess=!1;var n='{"Vod":{}}';d.addFile(this.$refs.image.files[0],null,null,null,n),d.addFile(this.$refs.video.files[0],null,null,null,n),d.startUpload()}}}),h=b,v=(n("5b09"),n("2877")),I=Object(v["a"])(h,r,a,!1,null,"2eeffe1b",null);t["default"]=I.exports},a9e3:function(e,t,n){"use strict";var r=n("83ab"),a=n("da84"),o=n("94ca"),s=n("6eeb"),c=n("5135"),l=n("c6b6"),i=n("7156"),u=n("c04e"),d=n("d039"),f=n("7c73"),p=n("241c").f,m=n("06cf").f,g=n("9bf2").f,b=n("58a8").trim,h="Number",v=a[h],I=v.prototype,y=l(f(I))==h,N=function(e){var t,n,r,a,o,s,c,l,i=u(e,!1);if("string"==typeof i&&i.length>2)if(i=b(i),t=i.charCodeAt(0),43===t||45===t){if(n=i.charCodeAt(2),88===n||120===n)return NaN}else if(48===t){switch(i.charCodeAt(1)){case 66:case 98:r=2,a=49;break;case 79:case 111:r=8,a=55;break;default:return+i}for(o=i.slice(2),s=o.length,c=0;c<s;c++)if(l=o.charCodeAt(c),l<48||l>a)return NaN;return parseInt(o,r)}return+i};if(o(h,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var A,U=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof U&&(y?d((function(){I.valueOf.call(n)})):l(n)!=h)?i(new v(N(t)),n,U):N(t)},w=r?p(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),x=0;w.length>x;x++)c(v,A=w[x])&&!c(U,A)&&g(U,A,m(v,A));U.prototype=I,I.constructor=U,s(a,h,U)}},b0c0:function(e,t,n){var r=n("83ab"),a=n("9bf2").f,o=Function.prototype,s=o.toString,c=/^\s*function ([^ (]*)/,l="name";r&&!(l in o)&&a(o,l,{configurable:!0,get:function(){try{return s.call(this).match(c)[1]}catch(e){return""}}})}}]);
//# sourceMappingURL=chunk-689115fc.b672a025.js.map